version: 1
status: active

workspace_identity:
  strategy: registry_uuid
  file: .qyl/workspace.json
  field: workspace_id
  generation:
    trigger: first_docker_compose_up
    mode: auto
    user_visible: false
  constraints:
    immutable: true
    survives_path_changes: true
    survives_symlinks: true

local_origin:
  strategy: loopback_ip
  allocation:
    cidr: 127.0.0.0/8
    start: 127.0.0.10
    deterministic_by_workspace_id: true
    persist_mapping: true
  routing:
    owner: dashboard_and_copilot
    user_visible_url_required: false
  oauth:
    deterministic_redirects: true
    callback_broker:
      enabled: true
      fixed_callback_endpoint: true
  cookie_isolation:
    by_ip_origin: true
    cross_workspace_cookie_sharing: denied

phase2_enforcement_policy:
  mode: opinionated_defaults
  principle: fail_closed_for_shared_state_warn_for_local_reversible

notification_interrupt_policy:
  severities:
    p0: immediate
    p1: digest_5m
    p2: digest
    p3: digest
  hard_cap_interruptions_per_hour: 6
  anti_storm:
    enabled: true
    collapse_similar_events: true

cost_guardrails:
  mode: adaptive
  latency_sensitive_override: allow
  budgets:
    soft:
      behavior:
        - warn
        - throttle_non_critical_exporters
    hard:
      behavior:
        - degrade_fidelity
      never_default_to_full_stop: true

secrets_v1:
  strategy: workspace_scoped_lifecycle
  external_secret_manager_required: false
  bootstrap: zero_external_setup
  management_surface: dashboard

ux_contract:
  principle: customer_decides_only_what_to_observe
  hidden_complexity:
    workspace_uuid_generation: true
    loopback_ip_routing: true
    policy_defaults: true
