---
title: "Architecture Overview"
description: "Understand qyl's component architecture and data flow"
---

# Architecture Overview

qyl is designed as a modular system with clear separation of concerns.

## Component diagram

```
┌─────────────────────────────────────────────────────────────────┐
│                        User Applications                         │
│              (Instrumented with OpenTelemetry SDKs)             │
└─────────────────────────────────────────────────────────────────┘
                               │
                    OTLP (HTTP/gRPC)
                               │
                               ▼
┌─────────────────────────────────────────────────────────────────┐
│                        qyl.collector                            │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────────────┐  │
│  │ OTLP Ingest  │  │ GenAI Extract│  │  REST/SSE API        │  │
│  │ HTTP + gRPC  │──│ gen_ai.*     │──│  /api/v1/sessions    │  │
│  └──────────────┘  └──────────────┘  │  /api/v1/traces      │  │
│                           │          │  /api/v1/live (SSE)  │  │
│                           ▼          └──────────────────────┘  │
│                    ┌──────────────┐           │                │
│                    │   DuckDB     │           │                │
│                    │   Storage    │───────────┘                │
│                    └──────────────┘                            │
└─────────────────────────────────────────────────────────────────┘
         │                                           │
    HTTP REST                                   HTTP REST
         │                                           │
         ▼                                           ▼
┌──────────────────┐                    ┌──────────────────────┐
│    qyl.mcp       │                    │   qyl.dashboard      │
│   ┌──────────┐   │                    │  ┌────────────────┐  │
│   │ MCP Tools│   │                    │  │   React 19     │  │
│   │ search   │   │                    │  │   TanStack Q5  │  │
│   │ sessions │   │                    │  │   Tailwind 4   │  │
│   └──────────┘   │                    │  └────────────────┘  │
└──────────────────┘                    └──────────────────────┘
         │                                           │
    stdio MCP                                   Browser
         │                                           │
         ▼                                           ▼
┌──────────────────┐                    ┌──────────────────────┐
│  Claude / AI     │                    │      Developer       │
│     Agents       │                    │                      │
└──────────────────┘                    └──────────────────────┘
```

## Components

| Component | Type | Purpose |
|-----------|------|---------|
| [qyl.collector](/architecture/collector) | Web API | OTLP ingestion, storage, REST API |
| [qyl.dashboard](/architecture/dashboard) | React SPA | Real-time visualization |
| [qyl.mcp](/architecture/mcp) | Console | AI agent integration via MCP |
| [qyl.protocol](/architecture/protocol) | Library | Shared types and contracts |

## Data flow

1. **Ingestion**: Apps send OTLP traces to collector (HTTP:5100 or gRPC:4317)
2. **Processing**: Collector extracts `gen_ai.*` attributes into structured fields
3. **Storage**: Spans persisted to embedded DuckDB (columnar, fast analytics)
4. **Query**: Dashboard and MCP query via REST API
5. **Stream**: Live updates via Server-Sent Events (SSE)

## Dependency rules

```
dashboard ──HTTP──► collector ◄──HTTP── mcp
                        │
                        ▼
                    protocol
```

<Warning>
  **Critical**: `qyl.mcp` communicates with `qyl.collector` via HTTP only. No `ProjectReference` allowed.
</Warning>

## Tech stack

| Layer | Technology |
|-------|------------|
| Runtime | .NET 10 / C# 14 |
| Storage | DuckDB (embedded columnar) |
| OTel | Semantic Conventions v1.39.0 |
| Frontend | React 19, Vite 6, Tailwind 4 |
| Testing | xUnit v3 + MTP |
