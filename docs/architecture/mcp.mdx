---
title: "MCP Architecture"
description: "Model Context Protocol server for AI agent integration"
---

# MCP Architecture

The MCP server enables AI agents like Claude to query their own telemetry.

## What is MCP?

Model Context Protocol (MCP) is a standard for AI agents to interact with external tools. qyl implements an MCP server that exposes telemetry query tools.

## Available tools

| Tool | Description |
|------|-------------|
| `search_sessions` | Find sessions by criteria |
| `get_session` | Get session details and spans |
| `search_traces` | Query traces with filters |
| `get_span` | Get specific span details |

## Directory structure

```
src/qyl.mcp/
├── Tools/                  # MCP tool implementations
│   ├── SearchSessionsTool.cs
│   ├── GetSessionTool.cs
│   └── SearchTracesTool.cs
├── Client/                 # HTTP client to collector
│   └── CollectorClient.cs
└── Program.cs
```

## Communication

```
Claude ──stdio──► qyl.mcp ──HTTP──► qyl.collector
```

<Warning>
  MCP communicates with collector via HTTP REST API only. No direct database access.
</Warning>

## Configuration

Add to Claude Code settings:

```json
{
  "mcpServers": {
    "qyl": {
      "command": "dotnet",
      "args": ["run", "--project", "src/qyl.mcp"],
      "env": {
        "QYL_COLLECTOR_URL": "http://localhost:5100"
      }
    }
  }
}
```
