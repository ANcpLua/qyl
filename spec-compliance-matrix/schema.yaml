project:
  name: qyl
  version: 2.0.0
  description: >-
    AI Observability Platform - Polyglot OpenTelemetry GenAI collector with
    embedded analytics (DuckDB), TypeSpec schemas, and real-time streaming.
    Vendor-neutral design with zero cloud lock-in.
  tech_stack:
    dotnet:
      version: net10.0
      language_version: '14.0'
      nullable: enabled
      implicit_usings: enabled
      aot_compatible: true
    typescript:
      version: '5.9'
      strict: true
    react:
      version: '19'
    python:
      version: '3.14'
    configuration:
      format: typespec
      source: core/specs/main.tsp
  typespec:
    version: 1.7.0
    entry_point: core/specs/main.tsp
    config: core/specs/tspconfig.yaml
    otel_semconv_version: 1.38.0
    namespaces:
      root: Qyl
      common: Qyl.Common
      errors: Qyl.Common.Errors
      pagination: Qyl.Common.Pagination
      otel: Qyl.OTel
      api: Qyl.Api
      streaming: Qyl.Api.Streaming
    common:
      path: core/specs/common
      modules:
        - name: types
          file: types.tsp
          description: Foundation scalars and common models
          exports:
            scalars:
              - TraceId
              - SpanId
              - SessionId
              - UserId
              - DurationMs
              - DurationNs
              - DurationS
              - ByteSize
              - TokenCount
              - Percentage
              - Ratio
              - Count
              - SemVer
              - IpAddress
              - Port
              - UrlString
              - UserAgent
              - ContentType
              - LanguageCode
              - Sha256Hash
            models:
              - Attribute
              - AttributeValue
            enums:
              - CloudProvider
        - name: errors
          file: errors.tsp
          description: HTTP error response models
          exports:
            models:
              - ApiError
              - ValidationError
              - NotFoundError
              - UnauthorizedError
              - ForbiddenError
              - ConflictError
              - RateLimitError
              - InternalServerError
            enums:
              - ErrorCode
        - name: pagination
          file: pagination.tsp
          description: Cursor and offset pagination
          exports:
            models:
              - CursorPage
              - OffsetPage
              - PageInfo
              - TimeRange
            enums:
              - TimeBucket
    otel:
      path: core/specs/otel
      modules:
        - name: enums
          file: enums.tsp
          description: Core OTel enumerations
          exports:
            enums:
              - SpanKind
              - SpanStatusCode
              - SeverityNumber
              - MetricType
              - AggregationTemporality
              - InstrumentKind
        - name: resource
          file: resource.tsp
          description: OTel Resource model
          exports:
            models:
              - Resource
              - InstrumentationScope
        - name: span
          file: span.tsp
          description: Span and Trace models
          exports:
            models:
              - Span
              - SpanEvent
              - SpanLink
              - SpanStatus
              - Trace
              - TraceStats
        - name: logs
          file: logs.tsp
          description: LogRecord model
          exports:
            models:
              - LogRecord
              - LogBody
              - LogStats
        - name: metrics
          file: metrics.tsp
          description: Metric models
          exports:
            models:
              - Metric
              - NumberDataPoint
              - HistogramDataPoint
              - ExponentialHistogramDataPoint
              - SummaryDataPoint
              - Exemplar
            enums:
              - AggregationFunction
    domains:
      ai:
        path: core/specs/domains/ai
        description: GenAI/LLM observability semantic conventions
        modules:
          - name: genai
            file: genai.tsp
            description: Core GenAI semantic conventions
            exports:
              models:
                - GenAiAttributes
                - GenAiRequestAttributes
                - GenAiResponseAttributes
                - GenAiUsageAttributes
                - GenAiToolCall
                - GenAiMessage
                - GenAiStats
                - GenAiCostEstimate
              enums:
                - GenAiSystem
                - GenAiOperationName
                - GenAiTokenType
                - GenAiFinishReason
          - name: code
            file: code.tsp
            description: Code and stack trace semantics
            exports:
              models:
                - CodeAttributes
                - StackTrace
                - StackFrame
              enums:
                - CodeFunctionType
          - name: cli
            file: cli.tsp
            description: CLI and agent telemetry
            exports:
              models:
                - CliAttributes
                - AgentRunAttributes
                - AgentTurn
                - ToolInvocation
              enums:
                - CliToolType
                - AgentState
                - ToolCategory
      security:
        path: core/specs/domains/security
        description: Network security and protocol telemetry
        modules:
          - name: network
            file: network.tsp
            exports:
              models:
                - NetworkAttributes
              enums:
                - NetworkType
                - NetworkTransport
          - name: dns
            file: dns.tsp
            exports:
              models:
                - DnsAttributes
              enums:
                - DnsRecordType
          - name: tls
            file: tls.tsp
            exports:
              models:
                - TlsAttributes
                - TlsCertificate
              enums:
                - TlsProtocolVersion
          - name: security-rule
            file: security-rule.tsp
            exports:
              models:
                - SecurityRuleAttributes
              enums:
                - SecurityRuleAction
                - SecurityRuleResult
      transport:
        path: core/specs/domains/transport
        description: 'HTTP, RPC, and messaging transport telemetry'
        modules:
          - name: http
            file: http.tsp
            exports:
              models:
                - HttpAttributes
                - HttpRequestAttributes
                - HttpResponseAttributes
                - HttpClientRequestDurationMetric
                - HttpServerRequestDurationMetric
              enums:
                - HttpRequestMethod
                - HttpFlavor
          - name: rpc
            file: rpc.tsp
            exports:
              models:
                - RpcAttributes
                - GrpcAttributes
              enums:
                - RpcSystem
                - RpcGrpcStatusCode
          - name: messaging
            file: messaging.tsp
            exports:
              models:
                - MessagingAttributes
                - MessagingBatchAttributes
              enums:
                - MessagingSystem
                - MessagingOperation
                - MessagingDestinationKind
          - name: url
            file: url.tsp
            exports:
              models:
                - UrlAttributes
          - name: signalr
            file: signalr.tsp
            exports:
              models:
                - SignalRAttributes
              enums:
                - SignalRTransport
                - SignalRConnectionStatus
          - name: kestrel
            file: kestrel.tsp
            exports:
              models:
                - KestrelAttributes
                - KestrelConnectionDurationMetric
                - KestrelActiveConnectionsMetric
              enums:
                - KestrelConnectionState
          - name: user-agent
            file: user-agent.tsp
            exports:
              models:
                - UserAgentAttributes
              enums:
                - UserAgentDeviceType
      infra:
        path: core/specs/domains/infra
        description: Infrastructure and cloud resource telemetry
        modules:
          - name: host
            file: host.tsp
            exports:
              models:
                - HostAttributes
              enums:
                - HostArch
                - HostType
          - name: container
            file: container.tsp
            exports:
              models:
                - ContainerAttributes
                - ContainerCpuUsageMetric
                - ContainerMemoryUsageMetric
                - ContainerNetworkIoMetric
                - ContainerDiskIoMetric
              enums:
                - ContainerRuntime
                - ContainerState
          - name: k8s
            file: k8s.tsp
            exports:
              models:
                - K8sAttributes
                - K8sEvent
                - K8sPodCpuMetric
                - K8sPodMemoryMetric
                - K8sDeploymentReplicasMetric
              enums:
                - K8sWorkloadKind
                - K8sPodPhase
                - K8sContainerState
                - K8sContainerWaitingReason
                - K8sEventType
                - K8sReplicaState
          - name: cloud
            file: cloud.tsp
            exports:
              models:
                - CloudAttributes
                - AwsAttributes
                - AzureAttributes
                - GcpAttributes
              enums:
                - CloudPlatform
                - AwsEcsLaunchType
          - name: faas
            file: faas.tsp
            exports:
              models:
                - FaasAttributes
                - FaasInvocationMetric
                - FaasInvocationDurationMetric
                - FaasColdStartMetric
                - FaasInitDurationMetric
              enums:
                - FaasTrigger
                - FaasDocumentOperation
          - name: os
            file: os.tsp
            exports:
              models:
                - OsAttributes
                - OsEntity
              enums:
                - OsType
                - HostArch
          - name: webengine
            file: webengine.tsp
            exports:
              models:
                - WebEngineAttributes
                - WebEngineEntity
                - WebEngineRequestsMetric
                - WebEngineConnectionsMetric
              enums:
                - WebEngineType
                - RuntimeLanguage
                - WebEngineName
                - ConnectionState
      runtime:
        path: core/specs/domains/runtime
        description: 'Process, system, and runtime telemetry'
        modules:
          - name: process
            file: process.tsp
            exports:
              models:
                - ProcessAttributes
                - ProcessCpuTimeMetric
                - ProcessCpuUtilizationMetric
                - ProcessMemoryUsageMetric
                - ProcessMemoryVirtualMetric
                - ProcessDiskIoMetric
                - ProcessNetworkIoMetric
                - ProcessThreadCountMetric
                - ProcessOpenFilesMetric
              enums:
                - ProcessCpuState
                - ProcessMemoryType
          - name: system
            file: system.tsp
            exports:
              models:
                - OsAttributes
                - SystemCpuUtilizationMetric
                - SystemCpuTimeMetric
                - SystemMemoryUsageMetric
                - SystemDiskIoMetric
                - SystemNetworkIoMetric
                - SystemFilesystemUsageMetric
              enums:
                - SystemCpuState
                - SystemMemoryState
                - SystemFilesystemState
                - SystemNetworkState
                - SystemPagingState
                - SystemPagingType
                - SystemProcessStatus
          - name: thread
            file: thread.tsp
            exports:
              models:
                - ThreadAttributes
                - ThreadPoolActiveMetric
                - ThreadPoolQueueLengthMetric
                - ThreadPoolSizeMetric
                - ThreadPoolCompletedMetric
              enums:
                - ThreadPoolState
          - name: dotnet
            file: dotnet.tsp
            exports:
              models:
                - DotNetAttributes
                - DotNetGcHeapSizeMetric
                - DotNetGcFragmentationMetric
                - DotNetGcCollectionsMetric
                - DotNetGcDurationMetric
                - DotNetGcAllocatedMetric
                - DotNetJitCompilationTimeMetric
                - DotNetThreadPoolThreadCountMetric
                - DotNetExceptionCountMetric
              enums:
                - DotNetGcGeneration
                - DotNetGcType
                - DotNetGcCompactionReason
          - name: aspnetcore
            file: aspnetcore.tsp
            exports:
              models:
                - AspNetCoreAttributes
                - AspNetCoreRoutingMatchAttemptsMetric
                - AspNetCoreRateLimitingRequestsMetric
                - AspNetCoreRequestDurationMetric
                - AspNetCoreActiveRequestsMetric
                - AspNetCoreRequestStartedEvent
                - AspNetCoreRequestCompletedEvent
              enums:
                - AspNetCoreRoutingMatchStatus
                - AspNetCoreRateLimitingResult
                - AspNetCoreExceptionResult
      data:
        path: core/specs/domains/data
        description: 'Database, file, and data storage telemetry'
        modules:
          - name: db
            file: db.tsp
            description: Database client semantics (45+ DBMS types)
            exports:
              models:
                - DbAttributes
                - DbClientOperationDurationMetric
                - DbConnectionPoolSizeMetric
                - DbStats
                - DbSystemStats
                - DbOperationStats
                - DbSlowQuery
              enums:
                - DbSystem
                - DbOperationName
                - DbConnectionState
          - name: file
            file: file.tsp
            exports:
              models:
                - FileAttributes
                - FileEvent
                - FileOperationsMetric
                - FileIoBytesMetric
              enums:
                - FileType
                - FileOperation
          - name: elasticsearch
            file: elasticsearch.tsp
            exports:
              models:
                - ElasticsearchAttributes
                - EsQueryDurationMetric
                - EsDocumentsIndexedMetric
                - EsIndexSizeMetric
              enums:
                - ElasticsearchAction
          - name: vcs
            file: vcs.tsp
            exports:
              models:
                - VcsAttributes
                - GitAttributes
                - VcsEvent
              enums:
                - VcsType
                - VcsRefType
                - VcsChangeState
                - VcsProviderName
                - VcsEventType
          - name: artifact
            file: artifact.tsp
            exports:
              models:
                - ArtifactAttributes
                - PackageUrl
                - SbomEntry
                - VulnerabilityRef
              enums:
                - HashAlgorithm
                - ArtifactType
                - VulnerabilitySeverity
      observe:
        path: core/specs/domains/observe
        description: Observability-specific telemetry models
        modules:
          - name: session
            file: session.tsp
            exports:
              models:
                - SessionAttributes
                - SessionEvent
                - SessionEntity
                - SessionClientInfo
                - SessionGeoInfo
                - SessionGenAiUsage
                - SessionStats
              enums:
                - SessionEventName
                - SessionState
                - DeviceType
          - name: browser
            file: browser.tsp
            description: Browser/RUM and Web Vitals
            exports:
              models:
                - BrowserAttributes
                - PageViewEvent
                - UserInteractionEvent
                - BrowserErrorEvent
                - WebVitalsLcpMetric
                - WebVitalsClsMetric
                - WebVitalsFidMetric
                - WebVitalsInpMetric
                - WebVitalsTtfbMetric
              enums:
                - BrowserInteractionType
                - BrowserErrorType
          - name: feature-flags
            file: feature-flags.tsp
            exports:
              models:
                - FeatureFlagAttributes
                - FeatureFlagEvaluationEvent
                - FeatureFlagChangeEvent
                - FeatureFlagEvaluationsMetric
              unions:
                - FeatureFlagValue
              enums:
                - FeatureFlagResultReason
                - FeatureFlagErrorCode
                - FeatureFlagProvider
          - name: exceptions
            file: exceptions.tsp
            exports:
              models:
                - ExceptionAttributes
                - ExceptionEvent
                - EnrichedException
                - ExceptionCountMetric
                - ExceptionStats
              enums:
                - ExceptionStatus
                - ExceptionTrend
          - name: otel
            file: otel.tsp
            description: OTel SDK configuration
            exports:
              models:
                - TelemetrySdkAttributes
                - TelemetryDistroAttributes
                - InstrumentationScopeDetails
                - OtelEndpointConfig
                - BatchProcessorConfig
                - SamplerConfig
                - ResourceDetectorConfig
                - PropagationConfig
                - OtelSdkConfig
                - TelemetryStats
              enums:
                - TelemetrySdkLanguage
                - OtlpProtocol
                - OtlpCompression
                - SamplerType
                - ResourceDetector
                - Propagator
          - name: log
            file: log.tsp
            exports:
              models:
                - LogAttributes
                - EventAttributes
                - LogQuery
                - AttributeFilter
                - LogAggregation
                - LogStats
                - LogPattern
              enums:
                - LogIostream
                - EventDomain
                - FilterOperator
                - LogOrderBy
                - AggregationFunction
                - TimeBucket
                - LogPatternTrend
                - StructuredLogFormat
          - name: error
            file: error.tsp
            exports:
              models:
                - ErrorAttributes
                - ErrorEntity
                - ErrorBudget
                - ErrorRateMetric
                - ErrorCountMetric
                - ErrorCorrelation
                - ErrorStats
              enums:
                - ErrorCategory
                - ErrorStatus
                - ErrorBudgetStatus
                - TemporalRelationship
                - ErrorTrend
          - name: test
            file: test.tsp
            exports:
              models:
                - TestAttributes
                - TestRunEntity
                - TestCaseEntity
                - TestRunCountMetric
                - TestCaseCountMetric
                - TestDurationMetric
                - CoverageReport
                - FileCoverage
              enums:
                - TestResultStatus
                - TestSuiteRunStatus
                - TestFramework
      ops:
        path: core/specs/domains/ops
        description: CI/CD and deployment telemetry
        modules:
          - name: cicd
            file: cicd.tsp
            exports:
              models:
                - CicdAttributes
                - PipelineRunEvent
                - PipelineDurationMetric
                - PipelineRunsMetric
                - DeploymentFrequencyMetric
              enums:
                - CicdTaskType
                - CicdPipelineStatus
                - CicdSystem
                - CicdEventName
                - CicdTriggerType
          - name: deployment
            file: deployment.tsp
            description: DORA metrics included
            exports:
              models:
                - DeploymentAttributes
                - DeploymentEntity
                - DeploymentEvent
                - DeploymentDurationMetric
                - DeploymentCountMetric
                - DoraDeploymentFrequencyMetric
                - DoraLeadTimeMetric
                - DoraChangeFailureRateMetric
                - DoraMttrMetric
              enums:
                - DeploymentEnvironment
                - DeploymentStatus
                - DeploymentStrategy
                - DeploymentEventName
      identity:
        path: core/specs/domains/identity
        description: 'User, service, and geo identity'
        modules:
          - name: user
            file: user.tsp
            exports:
              models:
                - UserAttributes
                - ClientAttributes
                - ServiceAttributes
                - AppAttributes
                - ServerAttributes
                - DestinationAttributes
                - SourceAttributes
                - PeerAttributes
                - UserActivityStats
                - ServiceDependency
          - name: geo
            file: geo.tsp
            exports:
              models:
                - GeoAttributes
                - GeoLocation
                - IpGeolocation
              scalars:
                - CountryCode
              enums:
                - ContinentCode
                - ConnectionType
    api:
      path: core/specs/api
      description: RESTful API contracts and streaming endpoints
      modules:
        - name: routes
          file: routes.tsp
          description: Complete REST API interfaces
          exports:
            interfaces:
              - TracesApi
              - LogsApi
              - MetricsApi
              - SessionsApi
              - ErrorsApi
              - ExceptionsApi
              - DeploymentsApi
              - PipelinesApi
              - ServicesApi
              - HealthApi
            models:
              - HealthResponse
              - TraceQuery
              - LogAggregationRequest
              - LogAggregationResponse
              - MetricQueryRequest
              - MetricQueryResponse
              - MetricMetadata
              - ServiceInfo
              - ServiceDetails
              - OperationInfo
              - DoraMetrics
            enums:
              - HealthStatus
              - ApiVersions
              - DoraPerformanceLevel
        - name: streaming
          file: streaming.tsp
          description: SSE streaming API
          exports:
            interfaces:
              - StreamingApi
            models:
              - TraceStreamEvent
              - SpanStreamEvent
              - LogStreamEvent
              - MetricStreamEvent
              - ExceptionStreamEvent
              - DeploymentStreamEvent
              - HeartbeatEvent
              - StreamSubscription
              - WebSocketMessage
              - TailSamplingConfig
            unions:
              - TelemetryStreamEvent
              - TraceEvents
              - SpanEvents
              - LogEvents
              - MetricEvents
              - ExceptionEvents
              - DeploymentEvents
            enums:
              - StreamEventType
              - WebSocketMessageType
  codegen:
    description: TypeSpec → OpenAPI → Kiota SDK generation pipeline
    pipeline:
      - step: TypeSpec compile
        input: core/specs/main.tsp
        output:
          - core/openapi/openapi.yaml
          - core/schemas/qyl-telemetry
      - step: Kiota generate
        input: core/openapi/openapi.yaml
        flags: --exclude-backward-compatible
        output:
          - core/generated/dotnet (C#, 169 files)
          - core/generated/python (Python, 169 files)
          - core/generated/typescript (TypeScript, 70 files)
    targets:
      openapi:
        emitter: '@typespec/openapi3'
        output: core/openapi/openapi.yaml
      json-schema:
        emitter: '@typespec/json-schema'
        output: core/schemas
      csharp:
        generator: kiota
        output: core/generated/dotnet
        namespace: Qyl.Core
      python:
        generator: kiota
        output: core/generated/python
      typescript:
        generator: kiota
        output: core/generated/typescript
    nuke_targets:
      - TypeSpecInstall
      - TypeSpecCompile
      - GenerateCSharp
      - GeneratePython
      - GenerateTypeScript
      - GenerateAll
      - SyncGeneratedTypes
      - TypeSpecInfo
      - TypeSpecClean
  statistics:
    total_tsp_files: 54
    breakdown:
      common: 3
      otel: 5
      domains_ai: 3
      domains_security: 4
      domains_transport: 7
      domains_infra: 7
      domains_runtime: 5
      domains_data: 5
      domains_observe: 8
      domains_ops: 2
      domains_identity: 2
      api: 2
      config: 1
  dependencies:
    rules:
      - instrumentation/* -> typespec/specs
      - collector/processing -> typespec/specs
      - collector/api -> collector/storage/abstractions
      - collector/api -> collector/processing
      - collector/streaming -> collector/storage/abstractions
      - collector/streaming -> collector/processing
      - collector/receivers/* -> collector/processing
      - dashboard -> collector/api (HTTP)
      - dashboard -> collector/streaming (SSE/WS)
      - cli -> collector/api (HTTP)
    prohibited:
      - core/* -> instrumentation/*
      - core/* -> collector/*
      - collector/* -> dashboard
      - collector/* -> cli
      - dashboard <-> cli
  artifacts:
    - name: qyl-collector
      type: single-binary
      description: >-
        Single executable serving API, Ingestion, and embedded Dashboard. No
        Aspire or vendor orchestration required.
      includes:
        - src/qyl.collector/**/*
        - core/generated/dotnet/**/*
        - src/qyl.dashboard/dist/**/*
    - name: qyl-cli
      type: dotnet-tool
      includes:
        - eng/qyl.cli/**/*
        - core/generated/dotnet/**/*
    - name: qyl-instrumentation-dotnet
      type: nuget-package
      includes:
        - src/qyl.agents.telemetry/**/*
    - name: qyl-sdk-csharp
      type: nuget-package
      includes:
        - core/generated/dotnet/**/*
    - name: qyl-sdk-python
      type: pypi-package
      includes:
        - core/generated/python/**/*
    - name: qyl-sdk-typescript
      type: npm-package
      includes:
        - core/generated/typescript/**/*
  structure:
    specs:
      path: core/specs
      files:
        - main.tsp
        - tspconfig.yaml
        - common/types.tsp
        - common/errors.tsp
        - common/pagination.tsp
        - otel/enums.tsp
        - otel/resource.tsp
        - otel/span.tsp
        - otel/logs.tsp
        - otel/metrics.tsp
        - domains/ai/genai.tsp
        - domains/ai/code.tsp
        - domains/ai/cli.tsp
        - domains/security/network.tsp
        - domains/security/dns.tsp
        - domains/security/tls.tsp
        - domains/security/security-rule.tsp
        - domains/transport/http.tsp
        - domains/transport/rpc.tsp
        - domains/transport/messaging.tsp
        - domains/transport/url.tsp
        - domains/transport/signalr.tsp
        - domains/transport/kestrel.tsp
        - domains/transport/user-agent.tsp
        - domains/infra/host.tsp
        - domains/infra/container.tsp
        - domains/infra/k8s.tsp
        - domains/infra/cloud.tsp
        - domains/infra/faas.tsp
        - domains/infra/os.tsp
        - domains/infra/webengine.tsp
        - domains/runtime/process.tsp
        - domains/runtime/system.tsp
        - domains/runtime/thread.tsp
        - domains/runtime/dotnet.tsp
        - domains/runtime/aspnetcore.tsp
        - domains/data/db.tsp
        - domains/data/file.tsp
        - domains/data/elasticsearch.tsp
        - domains/data/vcs.tsp
        - domains/data/artifact.tsp
        - domains/observe/session.tsp
        - domains/observe/browser.tsp
        - domains/observe/feature-flags.tsp
        - domains/observe/exceptions.tsp
        - domains/observe/otel.tsp
        - domains/observe/log.tsp
        - domains/observe/error.tsp
        - domains/observe/test.tsp
        - domains/ops/cicd.tsp
        - domains/ops/deployment.tsp
        - domains/identity/user.tsp
        - domains/identity/geo.tsp
        - api/routes.tsp
        - api/streaming.tsp
    instrumentation:
      dotnet:
        - QylInstrumentation.cs
        - AspNetCoreExtensions.cs
        - GeminiProvider.cs
        - Internals/LogEnricher.cs
        - Internals/OutboundContext.cs
      python:
        - qyl_instrumentation.py
      typescript:
        - telemetry.ts
    collector:
      host:
        - Program.cs
        - HostConfig.cs
      receivers:
        http:
          - HttpReceiver.cs
          - IngestionChannels.cs
        grpc:
          - GrpcReceiver.cs
      processing:
        - BatchProcessor.cs
        - GenAiExtractor.cs
        - AttributeNormalizer.cs
        - SessionAggregator.cs
        - PipelineMetrics.cs
        - DuckDbWriter.cs
      storage:
        abstractions:
          - IStore.cs
          - ISessionStore.cs
        memory:
          - MemoryStore.cs
        duckdb:
          - DuckDbStore.cs
          - SchemaInit.sql
      api:
        dtos:
          - SpanDto.cs
          - SessionDto.cs
          - GenAiDto.cs
        controllers:
          - QueryController.cs
          - SessionsController.cs
          - LogsController.cs
          - MetricsController.cs
      streaming:
        - SseHub.cs
        - TelemetryBroadcaster.cs
    dashboard:
      path: src/qyl.dashboard
      stack:
        - React 19
        - TypeScript 5.9
        - Tailwind v4
        - TanStack Query 5
        - Vite 7
        - Radix UI
      pages:
        - GenAIPage.tsx
        - TracesPage.tsx
        - LogsPage.tsx
        - MetricsPage.tsx
        - ResourcesPage.tsx
        - SettingsPage.tsx
      hooks:
        - use-telemetry.ts
        - use-keyboard-shortcuts.ts
        - use-theme.ts
      components:
        layout:
          - DashboardLayout.tsx
          - Sidebar.tsx
          - TopBar.tsx
        ui:
          - badge.tsx
          - button.tsx
          - card.tsx
          - input.tsx
          - select.tsx
          - tabs.tsx
          - tooltip.tsx
    cli:
      path: eng/qyl.cli
      files:
        - Program.cs
    analyzers:
      - QylDeprecatedAnalyzer.cs
      - QylSemconvAnalyzer.cs
  dotnet_apis:
    required:
      collections_linq:
        - api: 'CountBy<TSource, TKey>()'
          namespace: System.Linq
          dotnet_version: 9.0+
          use_in_qyl: SessionAggregator - single-pass histogram generation
          impact: Alloc-free frequency counting
        - api: 'AggregateBy<TSource, TKey, TAccumulate>()'
          namespace: System.Linq
          dotnet_version: 9.0+
          use_in_qyl: SessionAggregator - sum tokens/cost per session
        - api: Index<TSource>()
          namespace: System.Linq
          dotnet_version: 9.0+
          use_in_qyl: BatchProcessor - indexed enumeration
        - api: 'OrderedDictionary<TKey, TValue>'
          namespace: System.Collections.Generic
          dotnet_version: 9.0+
          use_in_qyl: TraceModel - preserve span insertion order
      concurrency_threading:
        - api: Lock class
          namespace: System.Threading
          dotnet_version: 9.0+
          use_in_qyl: 'SessionAggregator, SseHub'
        - api: Task.WhenEach()
          namespace: System.Threading.Tasks
          dotnet_version: 9.0+
          use_in_qyl: Receivers - process HTTP/gRPC as they complete
      strings_text:
        - api: SearchValues<char>
          namespace: System.Buffers
          dotnet_version: 8.0+
          use_in_qyl: GenAiExtractor - delimiter/character detection
        - api: ReadOnlySpan<char>.StartsWith
          namespace: System
          dotnet_version: all
          use_in_qyl: GenAiExtractor - prefix detection (gen_ai.*, agents.*)
        - api: CompositeFormat
          namespace: System.Text
          dotnet_version: 9.0+
          use_in_qyl: Logging Infrastructure
      json_serialization:
        - api: JsonNamingPolicy.SnakeCaseLower
          namespace: System.Text.Json
          dotnet_version: 10.0+
          use_in_qyl: API DTOs
      sse_streaming:
        - api: TypedResults.ServerSentEvents()
          namespace: Microsoft.AspNetCore.Http
          dotnet_version: 10.0+
          use_in_qyl: collector/streaming
  anti_patterns:
    description: Patterns that indicate pre-.NET 9/10 code - REJECT if produced
    reject_patterns:
      - pattern: private readonly object _lock = new();
        correct: private readonly Lock _lock = new();
        reason: Use .NET 9+ Lock class
      - pattern: '.GroupBy(x => x.Key).ToDictionary(g => g.Key, g => g.Count())'
        correct: .CountBy(x => x.Key)
        reason: Use .NET 9+ CountBy
      - pattern: ctx.Response.ContentType = "text/event-stream"
        correct: return TypedResults.ServerSentEvents(...)
        reason: Use .NET 10+ native SSE
      - pattern: key.Contains("value")
        correct: 'key.Contains("value", StringComparison.Ordinal)'
        reason: Explicit StringComparison required
      - pattern: 'new Dictionary<string, SpanModel>()'
        correct: 'new OrderedDictionary<string, SpanModel>()'
        reason: Use OrderedDictionary if order matters
  otel_compliance:
    semantic_conventions_version: '1.38'
    spec_url: 'https://opentelemetry.io/docs/specs/semconv/gen-ai/gen-ai-spans/'
    required_attributes:
      genai:
        - gen_ai.provider.name
        - gen_ai.request.model
        - gen_ai.usage.input_tokens
        - gen_ai.usage.output_tokens
        - gen_ai.usage.total_tokens
    deprecated_attributes:
      - old: gen_ai.system
        new: gen_ai.provider.name
        removed_in: '1.38'
      - old: gen_ai.usage.prompt_tokens
        new: gen_ai.usage.input_tokens
        removed_in: '1.38'
  ai_audit:
    version: 0.1.0
    description: Defines which semantic convention models are included in builds
    domains:
      - id: ai
        semconv_models:
          - gen-ai
          - code
          - cli
          - openai
        binary_capability:
          no_wall: true
          with_wall: true
        audit_minimum:
          - event.type
          - gen_ai.agent.id
          - gen_ai.operation.name
          - gen_ai.provider.name
          - gen_ai.request.model
          - gen_ai.response.model
          - gen_ai.usage.input_tokens
          - gen_ai.usage.output_tokens
      - id: security
        semconv_models:
          - security-rule
          - network
          - dns
          - tls
        binary_capability:
          no_wall: false
          with_wall: false
        audit_minimum:
          - event.type
          - security.rule.id
          - network.transport
          - network.protocol.name
          - dns.question.name
          - tls.protocol.version
      - id: transport
        semconv_models:
          - http
          - rpc
          - signalr
          - kestrel
          - url
        binary_capability:
          no_wall: true
          with_wall: false
        audit_minimum:
          - event.type
          - http.request.method
          - http.route
          - http.response.status_code
          - rpc.system
          - rpc.method
          - url.full
          - url.scheme
      - id: infra
        semconv_models:
          - container
          - process
          - system
          - thread
        binary_capability:
          no_wall: false
          with_wall: false
        audit_minimum:
          - event.type
          - container.id
          - container.name
          - process.pid
          - process.executable.name
          - system.cpu.utilization
          - thread.id
      - id: runtime
        semconv_models:
          - dotnet
          - aspnetcore
          - server
          - app
          - service
        binary_capability:
          no_wall: false
          with_wall: false
        audit_minimum:
          - event.type
          - service.name
          - service.version
          - service.instance.id
          - server.address
          - server.port
          - app.name
      - id: data
        semconv_models:
          - db
          - file
          - elasticsearch
          - vcs
        binary_capability:
          no_wall: true
          with_wall: false
        audit_minimum:
          - event.type
          - db.system.name
          - db.namespace
          - db.operation.name
          - db.collection.name
          - file.path
          - elasticsearch.node.name
          - vcs.repository.ref.name
      - id: observe
        semconv_models:
          - otel
          - telemetry
          - log
          - error
          - exceptions
          - session
          - destination
        binary_capability:
          no_wall: false
          with_wall: false
        audit_minimum:
          - event.type
          - log.record.severity_number
          - log.record.body
          - error.type
          - exception.type
          - exception.message
          - session.id
          - destination.address
      - id: ops
        semconv_models:
          - cicd
          - deployment
          - client
          - user
        binary_capability:
          no_wall: false
          with_wall: false
        audit_minimum:
          - event.type
          - cicd.pipeline.name
          - cicd.pipeline.run.id
          - deployment.environment.name
          - client.address
          - client.port
          - user.id
