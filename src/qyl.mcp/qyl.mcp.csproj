<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>net10.0</TargetFramework>
    <RuntimeIdentifiers>win-x64;win-arm64;osx-arm64;linux-x64;linux-arm64;linux-musl-x64</RuntimeIdentifiers>
    <OutputType>Exe</OutputType>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
    <!-- Inject shared code -->
    <InjectSharedThrow>true</InjectSharedThrow>

    <!-- Suppress A2A package AOT warnings - their JsonContext is private so we can't use it directly -->
    <!-- Suppress analyzer warnings for prototype code -->
    <NoWarn>$(NoWarn);IL2026;IL3050;MA0002;MA0004;MA0006;MA0011;MA0048;MA0158;CA1062;CA1515;CA1812;CA1852;CA2007</NoWarn>

    <!-- Set up the NuGet package to be an MCP server -->
    <PackAsTool>true</PackAsTool>
    <PackageType>McpServer</PackageType>

    <!-- Set up the MCP server to be a self-contained application during publish only -->
    <!-- SelfContained is set via publish command to allow project references from tests -->
    <PublishSelfContained>true</PublishSelfContained>

    <!-- Set up the MCP server to be a single file executable -->
    <PublishSingleFile>true</PublishSingleFile>

    <!-- Configure the MCP server to be a native AOT application with invariant globalization -->
    <PublishAot>true</PublishAot>
    <InvariantGlobalization>true</InvariantGlobalization>

    <!-- Set recommended package metadata -->
    <PackageReadmeFile>README.md</PackageReadmeFile>
    <PackageId>SampleMcpServer</PackageId>
    <PackageVersion>0.1.0-beta</PackageVersion>
    <PackageTags>AI; MCP; server; stdio</PackageTags>
    <Description>An MCP server using the MCP C# SDK.</Description>
  </PropertyGroup>

  <!-- Include additional files for browsing the MCP server. -->
  <ItemGroup>
    <None Include=".mcp\server.json" Pack="true" PackagePath="/.mcp/"/>
    <None Include="README.md" Pack="true" PackagePath="/"/>
  </ItemGroup>
  <ItemGroup>
    <PackageReference Include="Microsoft.Agents.AI"/>
    <PackageReference Include="Microsoft.Agents.AI.A2A"/>
    <PackageReference Include="Microsoft.Agents.AI.Abstractions"/>
    <PackageReference Include="Microsoft.Agents.AI.Hosting.A2A"/>
    <PackageReference Include="Microsoft.Agents.AI.Hosting.A2A.AspNetCore"/>
    <PackageReference Include="Microsoft.Extensions.Hosting"/>
    <PackageReference Include="ModelContextProtocol"/>
    <PackageReference Include="System.ClientModel"/>
    <!-- OpenTelemetry v1.38 GenAI Observability -->
    <PackageReference Include="OpenTelemetry.Api"/>
  </ItemGroup>

  <!-- Reference protocol only - communicate with collector via HTTP -->
  <ItemGroup>
    <ProjectReference Include="..\qyl.protocol\qyl.protocol.csproj"/>
  </ItemGroup>

</Project>
