{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "qyl-telemetry",
    "$defs": {
        "TraceId": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "TraceId.json",
            "type": "string",
            "examples": [
                "0af7651916cd43dd8448eb211c80319c"
            ],
            "minLength": 32,
            "maxLength": 32,
            "pattern": "^[a-f0-9]{32}$",
            "description": "Unique trace identifier (32 lowercase hex characters)"
        },
        "SpanId": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "SpanId.json",
            "type": "string",
            "examples": [
                "b7ad6b7169203331"
            ],
            "minLength": 16,
            "maxLength": 16,
            "pattern": "^[a-f0-9]{16}$",
            "description": "Unique span identifier (16 lowercase hex characters)"
        },
        "TraceParent": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "TraceParent.json",
            "type": "string",
            "examples": [
                "00-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-01"
            ],
            "pattern": "^[0-9a-f]{2}-[0-9a-f]{32}-[0-9a-f]{16}-[0-9a-f]{2}$",
            "description": "W3C Trace Context traceparent header format"
        },
        "TraceState": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "TraceState.json",
            "type": "string",
            "examples": [
                "rojo=00f067aa0ba902b7,congo=t61rcWkgMzE"
            ],
            "description": "W3C Trace Context tracestate header (vendor-specific key-value pairs)"
        },
        "SessionId": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "SessionId.json",
            "type": "string",
            "minLength": 1,
            "maxLength": 128,
            "description": "Unique session identifier"
        },
        "UserId": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "UserId.json",
            "type": "string",
            "minLength": 1,
            "maxLength": 256,
            "description": "User identifier (pseudonymized for privacy)"
        },
        "Timestamp": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "Timestamp.json",
            "type": "string",
            "format": "date-time",
            "description": "ISO 8601 timestamp with nanosecond precision (RFC 3339)"
        },
        "UnixNanos": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "UnixNanos.json",
            "type": "string",
            "format": "date-time",
            "description": "Unix timestamp in nanoseconds since epoch"
        },
        "DurationNs": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "DurationNs.json",
            "type": "string",
            "minimum": 0,
            "description": "Duration in nanoseconds"
        },
        "DurationMs": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "DurationMs.json",
            "type": "number",
            "minimum": 0,
            "description": "Duration in milliseconds"
        },
        "DurationS": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "DurationS.json",
            "type": "number",
            "minimum": 0,
            "description": "Duration in seconds"
        },
        "IsoDuration": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "IsoDuration.json",
            "type": "string",
            "format": "duration",
            "description": "ISO 8601 duration format (e.g., PT1H30M)"
        },
        "IPv4Address": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "IPv4Address.json",
            "type": "string",
            "examples": [
                "192.168.1.1"
            ],
            "pattern": "^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$",
            "description": "IPv4 address in dotted-decimal notation"
        },
        "IPv6Address": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "IPv6Address.json",
            "type": "string",
            "examples": [
                "2001:0db8:85a3:0000:0000:8a2e:0370:7334"
            ],
            "description": "IPv6 address in standard notation"
        },
        "IpAddress": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "IpAddress.json",
            "type": "string",
            "description": "IP address (IPv4 or IPv6)"
        },
        "Port": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "Port.json",
            "type": "integer",
            "minimum": 1,
            "maximum": 65535,
            "description": "Network port number (1-65535)"
        },
        "MacAddress": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "MacAddress.json",
            "type": "string",
            "examples": [
                "00:1A:2B:3C:4D:5E"
            ],
            "pattern": "^([0-9A-Fa-f]{2}:){5}[0-9A-Fa-f]{2}$",
            "description": "MAC address in colon-separated hex notation"
        },
        "ByteSize": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "ByteSize.json",
            "type": "string",
            "minimum": 0,
            "description": "Size in bytes"
        },
        "TokenCount": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "TokenCount.json",
            "type": "string",
            "minimum": 0,
            "description": "Token count (for LLM operations)"
        },
        "Count": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "Count.json",
            "type": "string",
            "minimum": 0,
            "description": "Generic non-negative counter"
        },
        "Percentage": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "Percentage.json",
            "type": "number",
            "minimum": 0,
            "maximum": 100,
            "description": "Percentage value (0.0 to 100.0)"
        },
        "Ratio": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "Ratio.json",
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Ratio value (0.0 to 1.0)"
        },
        "CostUsd": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "CostUsd.json",
            "type": "number",
            "minimum": 0,
            "description": "Cost in USD (floating point)"
        },
        "Temperature": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "Temperature.json",
            "type": "number",
            "minimum": 0,
            "maximum": 2,
            "description": "Temperature setting for LLM requests (0.0-2.0)"
        },
        "Sha256Hash": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "Sha256Hash.json",
            "type": "string",
            "minLength": 64,
            "maxLength": 64,
            "pattern": "^[a-f0-9]{64}$",
            "description": "SHA-256 hash in lowercase hex"
        },
        "SemVer": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "SemVer.json",
            "type": "string",
            "examples": [
                "2.1.0"
            ],
            "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",
            "description": "Semantic version string (e.g., 1.2.3)"
        },
        "UrlString": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "UrlString.json",
            "type": "string",
            "format": "uri",
            "description": "URL string (absolute)"
        },
        "UrlPath": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "UrlPath.json",
            "type": "string",
            "examples": [
                "/api/v1/users"
            ],
            "description": "URL path component"
        },
        "UrlQuery": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "UrlQuery.json",
            "type": "string",
            "examples": [
                "page=1&limit=100"
            ],
            "description": "URL query string (without leading ?)"
        },
        "HttpMethod": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "HttpMethod.json",
            "type": "string",
            "examples": [
                "GET"
            ],
            "description": "HTTP method name (uppercase)"
        },
        "ContentType": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "ContentType.json",
            "type": "string",
            "examples": [
                "application/json"
            ],
            "description": "MIME content type"
        },
        "UserAgent": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "UserAgent.json",
            "type": "string",
            "examples": [
                "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"
            ],
            "description": "User agent string"
        },
        "LanguageCode": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "LanguageCode.json",
            "type": "string",
            "examples": [
                "en-US"
            ],
            "pattern": "^[a-z]{2,3}(-[A-Z]{2})?$",
            "description": "Language/locale code (BCP 47)"
        },
        "SpanRecord": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "SpanRecord.json",
            "type": "object",
            "properties": {
                "spanId": {
                    "$ref": "SpanId.json",
                    "description": "Unique span identifier"
                },
                "traceId": {
                    "$ref": "TraceId.json",
                    "description": "Trace identifier"
                },
                "parentSpanId": {
                    "$ref": "SpanId.json",
                    "description": "Parent span identifier (null for root spans)"
                },
                "sessionId": {
                    "$ref": "SessionId.json",
                    "description": "Session identifier for grouping related traces"
                },
                "name": {
                    "type": "string",
                    "minLength": 1,
                    "description": "Human-readable span name"
                },
                "kind": {
                    "$ref": "#/$defs/SpanKind",
                    "description": "Span kind"
                },
                "startTimeUnixNano": {
                    "type": "string",
                    "description": "Start timestamp in nanoseconds since epoch"
                },
                "endTimeUnixNano": {
                    "type": "string",
                    "description": "End timestamp in nanoseconds since epoch"
                },
                "durationNs": {
                    "$ref": "DurationNs.json",
                    "description": "Duration in nanoseconds"
                },
                "statusCode": {
                    "$ref": "#/$defs/SpanStatusCode",
                    "description": "Span status code"
                },
                "statusMessage": {
                    "type": "string",
                    "description": "Status message (only for ERROR status)"
                },
                "serviceName": {
                    "type": "string",
                    "description": "Service name from resource attributes"
                },
                "genAiProviderName": {
                    "type": "string",
                    "description": "GenAI provider name (e.g., openai, anthropic) - OTel 1.39: gen_ai.provider.name"
                },
                "genAiRequestModel": {
                    "type": "string",
                    "description": "Requested model name"
                },
                "genAiResponseModel": {
                    "type": "string",
                    "description": "Actual response model name"
                },
                "genAiInputTokens": {
                    "$ref": "TokenCount.json",
                    "description": "Input/prompt tokens"
                },
                "genAiOutputTokens": {
                    "$ref": "TokenCount.json",
                    "description": "Output/completion tokens"
                },
                "genAiTemperature": {
                    "$ref": "Temperature.json",
                    "description": "Request temperature"
                },
                "genAiStopReason": {
                    "type": "string",
                    "description": "Response finish reason"
                },
                "genAiToolName": {
                    "type": "string",
                    "description": "Tool name for tool calls"
                },
                "genAiToolCallId": {
                    "type": "string",
                    "description": "Tool call ID"
                },
                "genAiCostUsd": {
                    "$ref": "CostUsd.json",
                    "description": "Estimated cost in USD"
                },
                "attributesJson": {
                    "type": "string",
                    "description": "All span attributes as JSON"
                },
                "resourceJson": {
                    "type": "string",
                    "description": "Resource attributes as JSON"
                },
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Row creation timestamp"
                }
            },
            "required": [
                "spanId",
                "traceId",
                "name",
                "kind",
                "startTimeUnixNano",
                "endTimeUnixNano",
                "durationNs",
                "statusCode"
            ],
            "description": "OpenTelemetry span record for storage and query",
            "$defs": {
                "SpanKind": {
                    "type": "number",
                    "enum": [
                        0,
                        1,
                        2,
                        3,
                        4,
                        5
                    ],
                    "description": "Span kind describing the relationship between spans"
                },
                "SpanStatusCode": {
                    "type": "number",
                    "enum": [
                        0,
                        1,
                        2
                    ],
                    "description": "Span status code"
                }
            }
        },
        "SessionSummary": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "SessionSummary.json",
            "type": "object",
            "properties": {
                "sessionId": {
                    "$ref": "SessionId.json",
                    "description": "Session identifier"
                },
                "startTime": {
                    "type": "string",
                    "description": "First span timestamp"
                },
                "endTime": {
                    "type": "string",
                    "description": "Last span timestamp"
                },
                "spanCount": {
                    "$ref": "Count.json",
                    "description": "Total span count"
                },
                "errorCount": {
                    "$ref": "Count.json",
                    "description": "Error span count"
                },
                "totalInputTokens": {
                    "$ref": "TokenCount.json",
                    "description": "Total input tokens"
                },
                "totalOutputTokens": {
                    "$ref": "TokenCount.json",
                    "description": "Total output tokens"
                },
                "totalCostUsd": {
                    "$ref": "CostUsd.json",
                    "description": "Total cost in USD"
                },
                "serviceName": {
                    "type": "string",
                    "description": "Primary service name"
                },
                "genAiProviderName": {
                    "type": "string",
                    "description": "Primary GenAI provider"
                },
                "genAiModel": {
                    "type": "string",
                    "description": "Primary model used"
                }
            },
            "required": [
                "sessionId",
                "startTime",
                "endTime",
                "spanCount",
                "errorCount",
                "totalInputTokens",
                "totalOutputTokens",
                "totalCostUsd"
            ],
            "description": "Session summary with aggregated metrics"
        },
        "LogRecordStorage": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "LogRecordStorage.json",
            "type": "object",
            "properties": {
                "logId": {
                    "type": "string",
                    "description": "Unique log record identifier"
                },
                "traceId": {
                    "$ref": "TraceId.json",
                    "description": "Associated trace ID"
                },
                "spanId": {
                    "$ref": "SpanId.json",
                    "description": "Associated span ID"
                },
                "sessionId": {
                    "$ref": "SessionId.json",
                    "description": "Session identifier for grouping related logs"
                },
                "timeUnixNano": {
                    "type": "string",
                    "description": "Timestamp when the event occurred (nanoseconds since epoch)"
                },
                "observedTimeUnixNano": {
                    "type": "string",
                    "description": "Timestamp when the log was observed/collected"
                },
                "severityNumber": {
                    "$ref": "#/$defs/SeverityNumber",
                    "description": "Severity number (1-24)"
                },
                "severityText": {
                    "type": "string",
                    "description": "Severity text (TRACE, DEBUG, INFO, WARN, ERROR, FATAL)"
                },
                "body": {
                    "type": "string",
                    "description": "Log body - the main content"
                },
                "serviceName": {
                    "type": "string",
                    "description": "Service name from resource attributes"
                },
                "attributesJson": {
                    "type": "string",
                    "description": "Log attributes as JSON"
                },
                "resourceJson": {
                    "type": "string",
                    "description": "Resource attributes as JSON"
                },
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Row creation timestamp"
                }
            },
            "required": [
                "logId",
                "timeUnixNano",
                "severityNumber"
            ],
            "description": "OpenTelemetry log record for storage and query",
            "$defs": {
                "SeverityNumber": {
                    "type": "number",
                    "enum": [
                        0,
                        1,
                        2,
                        3,
                        4,
                        5,
                        6,
                        7,
                        8,
                        9,
                        10,
                        11,
                        12,
                        13,
                        14,
                        15,
                        16,
                        17,
                        18,
                        19,
                        20,
                        21,
                        22,
                        23,
                        24
                    ],
                    "description": "Log severity number following OTel specification (1-24)"
                }
            }
        },
        "TraceNode": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "TraceNode.json",
            "type": "object",
            "properties": {
                "span": {
                    "$ref": "SpanRecord.json",
                    "description": "Span data"
                },
                "children": {
                    "type": "array",
                    "items": {
                        "$ref": "TraceNode.json"
                    },
                    "description": "Child spans"
                },
                "depth": {
                    "type": "integer",
                    "minimum": -2147483648,
                    "maximum": 2147483647,
                    "description": "Depth in tree (0 = root)"
                }
            },
            "required": [
                "span",
                "children",
                "depth"
            ],
            "description": "Trace tree node for hierarchical span display"
        },
        "GenAiSpanData": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "GenAiSpanData.json",
            "type": "object",
            "properties": {
                "providerName": {
                    "type": "string",
                    "description": "Provider name"
                },
                "requestModel": {
                    "type": "string",
                    "description": "Requested model"
                },
                "responseModel": {
                    "type": "string",
                    "description": "Response model"
                },
                "inputTokens": {
                    "$ref": "TokenCount.json",
                    "description": "Input tokens"
                },
                "outputTokens": {
                    "$ref": "TokenCount.json",
                    "description": "Output tokens"
                },
                "temperature": {
                    "$ref": "Temperature.json",
                    "description": "Temperature"
                },
                "stopReason": {
                    "type": "string",
                    "description": "Finish reason"
                },
                "toolName": {
                    "type": "string",
                    "description": "Tool name"
                },
                "toolCallId": {
                    "type": "string",
                    "description": "Tool call ID"
                },
                "costUsd": {
                    "$ref": "CostUsd.json",
                    "description": "Estimated cost"
                }
            },
            "description": "Extracted GenAI attributes from a span"
        }
    }
}